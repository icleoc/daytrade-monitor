<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Market Dashboard</title>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<style>
body { font-family: Arial, sans-serif; background: #f2f2f2; margin: 0; }
h1 { text-align: center; margin-top: 20px; }
.container { display: flex; flex-wrap: wrap; justify-content: center; margin-top: 30px; }
.card {
  background: white;
  border-radius: 10px;
  padding: 20px;
  margin: 10px;
  width: 200px;
  text-align: center;
  box-shadow: 0 2px 6px rgba(0,0,0,0.15);
}
.signal-buy { color: green; font-weight: bold; }
.signal-sell { color: red; font-weight: bold; }
#chart { width: 80%; margin: 40px auto; height: 400px; }
</style>
</head>
<body>
<h1>Market Dashboard</h1>
<div id="cards" class="container"></div>
<h2 style="text-align:center;">VWAP: <span id="vwap">...</span></h2>
<div id="chart"></div>

<script>
async function fetchData() {
  const res = await fetch('/api/data');
  const data = await res.json();

  const container = document.getElementById('cards');
  container.innerHTML = '';

  for (const [symbol, price] of Object.entries(data.prices)) {
    const signal = data.signals[symbol];
    const signalClass = signal === 'BUY' ? 'signal-buy' : 'signal-sell';
    container.innerHTML += `
      <div class="card">
        <h3>${symbol}</h3>
        <p>Price: $${price.toFixed(2)}</p>
        <p class="${signalClass}">${signal}</p>
      </div>`;
  }

  document.getElementById('vwap').textContent = data.vwap;

  const chartData = [{
    x: Object.keys(data.prices),
    y: Object.values(data.prices),
    type: 'bar',
    marker: { color: 'orange' }
  }];
  Plotly.newPlot('chart', chartData);
}

// Atualiza a cada 1 minuto
fetchData();
setInterval(fetchData, 60000);
</script>
</body>
</html>
